<!doctype html><html lang=en>
<head><meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Conda 复制已有环境 由于服务器上本身已经有使用CUDA平台的ToD-BERT运行环境，仅需将此环境中所有使用GPU的库换为使用CPU的库即可：pytorch
查看已有环境
(base) dialogue@amax-13:/$ conda info --env # conda environments: # base * /media/HD1/dche/miniconda3 sum_env /media/HD1/dche/miniconda3/envs/sum_env tod_bert /media/HD1/dche/miniconda3/envs/tod_bert /media/HD1/miniconda3 创建新环境，并将原有环境中的所有包复制，并激活新建立的环境。
(base) dialogue@amax-13:/$ conda create -n tod_bert_cpu --clone tod_bert Source: /media/HD1/dche/miniconda3/envs/tod_bert Destination: /media/HD1/dche/miniconda3/envs/tod_bert_cpu Packages: 20 Files: 12683 Preparing transaction: done Verifying transaction: done Executing transaction: done # # To activate this environment, use # # $ conda activate tod_bert_cpu # # To deactivate an active environment, use # # $ conda deactivate (base) dialogue@amax-13:/$ conda activate tod_bert_cpu (tod_bert_cpu) dialogue@amax-13:/$ Conda配置环境中的包（卸载GPU版本、安装CPU版本） Conda 查看环境中所有包的信息"><title>服务器配置CPU版ToD-BERT环境</title>
<link rel=canonical href=https://comfluter.life/p/%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AEcpu%E7%89%88tod-bert%E7%8E%AF%E5%A2%83/>
<link rel=stylesheet href=/scss/style.min.css><meta property="og:title" content="服务器配置CPU版ToD-BERT环境">
<meta property="og:description" content="Conda 复制已有环境 由于服务器上本身已经有使用CUDA平台的ToD-BERT运行环境，仅需将此环境中所有使用GPU的库换为使用CPU的库即可：pytorch
查看已有环境
(base) dialogue@amax-13:/$ conda info --env # conda environments: # base * /media/HD1/dche/miniconda3 sum_env /media/HD1/dche/miniconda3/envs/sum_env tod_bert /media/HD1/dche/miniconda3/envs/tod_bert /media/HD1/miniconda3 创建新环境，并将原有环境中的所有包复制，并激活新建立的环境。
(base) dialogue@amax-13:/$ conda create -n tod_bert_cpu --clone tod_bert Source: /media/HD1/dche/miniconda3/envs/tod_bert Destination: /media/HD1/dche/miniconda3/envs/tod_bert_cpu Packages: 20 Files: 12683 Preparing transaction: done Verifying transaction: done Executing transaction: done # # To activate this environment, use # # $ conda activate tod_bert_cpu # # To deactivate an active environment, use # # $ conda deactivate (base) dialogue@amax-13:/$ conda activate tod_bert_cpu (tod_bert_cpu) dialogue@amax-13:/$ Conda配置环境中的包（卸载GPU版本、安装CPU版本） Conda 查看环境中所有包的信息">
<meta property="og:url" content="https://comfluter.life/p/%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AEcpu%E7%89%88tod-bert%E7%8E%AF%E5%A2%83/">
<meta property="og:site_name" content="知止堂">
<meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="ToD-BERT"><meta property="article:tag" content="大创 AI对话系统"><meta property="article:tag" content="anaconda"><meta property="article:published_time" content="2021-11-24T00:00:00+00:00"><meta property="article:modified_time" content="2021-11-24T00:00:00+00:00">
<meta name=twitter:title content="服务器配置CPU版ToD-BERT环境">
<meta name=twitter:description content="Conda 复制已有环境 由于服务器上本身已经有使用CUDA平台的ToD-BERT运行环境，仅需将此环境中所有使用GPU的库换为使用CPU的库即可：pytorch
查看已有环境
(base) dialogue@amax-13:/$ conda info --env # conda environments: # base * /media/HD1/dche/miniconda3 sum_env /media/HD1/dche/miniconda3/envs/sum_env tod_bert /media/HD1/dche/miniconda3/envs/tod_bert /media/HD1/miniconda3 创建新环境，并将原有环境中的所有包复制，并激活新建立的环境。
(base) dialogue@amax-13:/$ conda create -n tod_bert_cpu --clone tod_bert Source: /media/HD1/dche/miniconda3/envs/tod_bert Destination: /media/HD1/dche/miniconda3/envs/tod_bert_cpu Packages: 20 Files: 12683 Preparing transaction: done Verifying transaction: done Executing transaction: done # # To activate this environment, use # # $ conda activate tod_bert_cpu # # To deactivate an active environment, use # # $ conda deactivate (base) dialogue@amax-13:/$ conda activate tod_bert_cpu (tod_bert_cpu) dialogue@amax-13:/$ Conda配置环境中的包（卸载GPU版本、安装CPU版本） Conda 查看环境中所有包的信息">
<link rel="shortcut icon" href=/siteIcon/favicon.ico>
</head>
<body class="article-page has-toc">
<script>(function(){const a='StackColorScheme';localStorage.getItem(a)||localStorage.setItem(a,"auto")})()</script><script>(function(){const b='StackColorScheme',a=localStorage.getItem(b),c=window.matchMedia('(prefers-color-scheme: dark)').matches===!0;a=='dark'||a==='auto'&&c?document.documentElement.dataset.scheme='dark':document.documentElement.dataset.scheme='light'})()</script>
<div class="container main-container flex
extended">
<div id=article-toolbar>
<a href=/ class=back-home><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="15 6 9 12 15 18"/></svg>
<span>Back</span>
</a>
</div>
<main class="main full-width">
<article class=main-article>
<header class=article-header>
<div class=article-details>
<header class=article-category>
<a href=/categories/%E6%A0%BC%E8%87%B4%E9%9B%86/>
格致集
</a>
</header>
<h2 class=article-title>
<a href=/p/%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AEcpu%E7%89%88tod-bert%E7%8E%AF%E5%A2%83/>服务器配置CPU版ToD-BERT环境</a>
</h2>
<footer class=article-time>
<div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Nov 24, 2021</time>
</div>
<div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>
5 minute read
</time>
</div>
</footer>
</div>
</header>
<section class=article-content>
<h2 id=conda-复制已有环境>Conda 复制已有环境</h2>
<p>由于服务器上本身已经有使用CUDA平台的ToD-BERT运行环境，仅需将此环境中所有使用GPU的库换为使用CPU的库即可：pytorch</p>
<p>查看已有环境</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=o>(</span>base<span class=o>)</span> dialogue@amax-13:/$ conda info --env
<span class=c1># conda environments:</span>
<span class=c1>#</span>
base                  *  /media/HD1/dche/miniconda3
sum_env                  /media/HD1/dche/miniconda3/envs/sum_env
tod_bert                 /media/HD1/dche/miniconda3/envs/tod_bert
                         /media/HD1/miniconda3
</code></pre></div><p>创建新环境，并将原有环境中的所有包复制，并激活新建立的环境。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=o>(</span>base<span class=o>)</span> dialogue@amax-13:/$ conda create -n tod_bert_cpu --clone tod_bert
Source:      /media/HD1/dche/miniconda3/envs/tod_bert
Destination: /media/HD1/dche/miniconda3/envs/tod_bert_cpu
Packages: <span class=m>20</span>
Files: <span class=m>12683</span>
Preparing transaction: <span class=k>done</span>
Verifying transaction: <span class=k>done</span>
Executing transaction: <span class=k>done</span>
<span class=c1>#</span>
<span class=c1># To activate this environment, use</span>
<span class=c1>#</span>
<span class=c1>#     $ conda activate tod_bert_cpu</span>
<span class=c1>#</span>
<span class=c1># To deactivate an active environment, use</span>
<span class=c1>#</span>
<span class=c1>#     $ conda deactivate</span>

<span class=o>(</span>base<span class=o>)</span> dialogue@amax-13:/$ conda activate tod_bert_cpu
<span class=o>(</span>tod_bert_cpu<span class=o>)</span> dialogue@amax-13:/$ 
</code></pre></div><h2 id=conda配置环境中的包卸载gpu版本安装cpu版本>Conda配置环境中的包（卸载GPU版本、安装CPU版本）</h2>
<p>Conda 查看环境中所有包的信息</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=o>(</span>tod_bert_cpu<span class=o>)</span> dialogue@amax-13:/$ conda list
<span class=c1># packages in environment at /media/HD1/dche/miniconda3/envs/tod_bert_cpu:</span>
<span class=c1>#</span>
<span class=c1># Name                    Version                   Build  Channel</span>
_libgcc_mutex             0.1                        main  
_openmp_mutex             4.5                       1_gnu  
anykeystore               0.2                      pypi_0    pypi
apex                      0.9.8.dev0               pypi_0    pypi
blessings                 1.7                      pypi_0    pypi
ca-certificates           2021.10.26           h06a4308_2  
certifi                   2021.10.8        py37h06a4308_0  
charset-normalizer        2.0.7                    pypi_0    pypi
click                     8.0.3                    pypi_0    pypi
cryptacular               1.6.2                    pypi_0    pypi
defusedxml                0.7.1                    pypi_0    pypi
filelock                  3.4.0                    pypi_0    pypi
future                    0.18.2                   pypi_0    pypi
gpustat                   0.6.0                    pypi_0    pypi
greenlet                  1.1.2                    pypi_0    pypi
hupper                    1.10.3                   pypi_0    pypi
idna                      3.3                      pypi_0    pypi
importlib-metadata        4.8.2                    pypi_0    pypi
joblib                    1.1.0                    pypi_0    pypi
libedit                   3.1.20210910         h7f8727e_0  
libffi                    3.2.1             hf484d3e_1007  
libgcc-ng                 9.3.0               h5101ec6_17  
libgomp                   9.3.0               h5101ec6_17  
libstdcxx-ng              9.3.0               hd4cf53a_17  
markupsafe                2.0.1                    pypi_0    pypi
ncurses                   6.3                  h7f8727e_2  
nltk                      3.5                      pypi_0    pypi
numpy                     1.18.1                   pypi_0    pypi
nvidia-ml-py3             7.352.0                  pypi_0    pypi
oauthlib                  3.1.1                    pypi_0    pypi
openssl                   1.0.2u               h7b6447c_0  
packaging                 21.3                     pypi_0    pypi
pastedeploy               2.1.1                    pypi_0    pypi
pbkdf2                    1.3                      pypi_0    pypi
pip                       21.2.2           py37h06a4308_0  
plaster                   1.0                      pypi_0    pypi
plaster-pastedeploy       0.7                      pypi_0    pypi
protobuf                  3.19.1                   pypi_0    pypi
psutil                    5.8.0                    pypi_0    pypi
ptvsd                     4.3.2                    pypi_0    pypi
pyparsing                 3.0.6                    pypi_0    pypi
pyramid                   2.0                      pypi_0    pypi
pyramid-mailer            0.15.1                   pypi_0    pypi
python                    3.7.0                h6e4f718_3  
python3-openid            3.2.0                    pypi_0    pypi
readline                  7.0                  h7b6447c_5  
regex                     2021.11.10               pypi_0    pypi
repoze-sendmail           4.4.1                    pypi_0    pypi
requests                  2.26.0                   pypi_0    pypi
requests-oauthlib         1.3.0                    pypi_0    pypi
sacremoses                0.0.46                   pypi_0    pypi
scikit-learn              0.23.2                   pypi_0    pypi
scipy                     1.7.2                    pypi_0    pypi
sentencepiece             0.1.96                   pypi_0    pypi
setuptools                58.0.4           py37h06a4308_0  
simplejson                3.17.2                   pypi_0    pypi
six                       1.15.0                   pypi_0    pypi
sqlalchemy                1.4.27                   pypi_0    pypi
sqlite                    3.33.0               h62c20be_0  
tensorboardx              2.1                      pypi_0    pypi
threadpoolctl             3.0.0                    pypi_0    pypi
tk                        8.6.11               h1ccaba5_0  
tokenizers                0.8.1rc1                 pypi_0    pypi
torch                     1.6.0                    pypi_0    pypi
tqdm                      4.31.1                   pypi_0    pypi
transaction               3.0.1                    pypi_0    pypi
transformers              3.0.2                    pypi_0    pypi
translationstring         1.4                      pypi_0    pypi
typing-extensions         4.0.0                    pypi_0    pypi
urllib3                   1.26.7                   pypi_0    pypi
velruse                   1.1.1                    pypi_0    pypi
venusian                  3.0.0                    pypi_0    pypi
webob                     1.8.7                    pypi_0    pypi
wheel                     0.37.0             pyhd3eb1b0_1  
wtforms                   3.0.0                    pypi_0    pypi
wtforms-recaptcha         0.3.2                    pypi_0    pypi
xz                        5.2.5                h7b6447c_0  
zipp                      3.6.0                    pypi_0    pypi
zlib                      1.2.11               h7b6447c_3  
zope-deprecation          4.4.0                    pypi_0    pypi
zope-interface            5.4.0                    pypi_0    pypi
zope-sqlalchemy           1.6                      pypi_0    pypi
</code></pre></div><p>卸载原有的GPU版本torch，貌似原先是使用pip安装的，在尝试conda卸载无果后使用pip卸载成功。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=o>(</span>tod_bert_cpu<span class=o>)</span> dialogue@amax-13:/$ conda remove pytorch
Collecting package metadata <span class=o>(</span>repodata.json<span class=o>)</span>: <span class=k>done</span>
Solving environment: failed

PackagesNotFoundError: The following packages are missing from the target environment:
  - pytorch


<span class=o>(</span>tod_bert_cpu<span class=o>)</span> dialogue@amax-13:/$ pip uninstall torch
Found existing installation: torch 1.6.0
Uninstalling torch-1.6.0:
  Would remove:
    /media/HD1/dche/miniconda3/envs/tod_bert_cpu/bin/convert-caffe2-to-onnx
    /media/HD1/dche/miniconda3/envs/tod_bert_cpu/bin/convert-onnx-to-caffe2
    /media/HD1/dche/miniconda3/envs/tod_bert_cpu/lib/python3.7/site-packages/caffe2/*
    /media/HD1/dche/miniconda3/envs/tod_bert_cpu/lib/python3.7/site-packages/torch-1.6.0.dist-info/*
    /media/HD1/dche/miniconda3/envs/tod_bert_cpu/lib/python3.7/site-packages/torch/*
Proceed <span class=o>(</span>Y/n<span class=o>)</span>? y
  Successfully uninstalled torch-1.6.0
</code></pre></div><p>安装cpu版本torch</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=o>(</span>tod_bert_cpu<span class=o>)</span> dialogue@amax-13:/$ conda install <span class=nv>pytorch</span><span class=o>==</span>1.6.0 <span class=nv>torchvision</span><span class=o>==</span>0.7.0 cpuonly -c pytorch
Collecting package metadata <span class=o>(</span>current_repodata.json<span class=o>)</span>: <span class=k>done</span>
Solving environment: <span class=k>done</span>

<span class=c1>## Package Plan ##</span>

  environment location: /media/HD1/dche/miniconda3/envs/tod_bert_cpu

  added / updated specs:
    - cpuonly
    - <span class=nv>pytorch</span><span class=o>==</span>1.6.0
    - <span class=nv>torchvision</span><span class=o>==</span>0.7.0


The following packages will be downloaded:

    <span class=p>|</span> package               <span class=p>|</span> build                               <span class=p>|</span>
    <span class=p>|</span> --------------------- <span class=p>|</span> ----------------------------------- <span class=p>|</span>
    <span class=p>|</span> blas-1.0              <span class=p>|</span> mkl           <span class=m>6</span> KB                  <span class=p>|</span>
    <span class=p>|</span> cpuonly-2.0           <span class=p>|</span> <span class=m>0</span>           <span class=m>2</span> KB  pytorch           <span class=p>|</span>
    <span class=p>|</span> freetype-2.11.0       <span class=p>|</span> h70c0345_0         <span class=m>618</span> KB           <span class=p>|</span>
    <span class=p>|</span> giflib-5.2.1          <span class=p>|</span> h7b6447c_0          <span class=m>78</span> KB           <span class=p>|</span>
    <span class=p>|</span> intel-openmp-2021.4.0 <span class=p>|</span> h06a4308_3561         4.2 MB        <span class=p>|</span>
    <span class=p>|</span> jpeg-9d               <span class=p>|</span> h7f8727e_0         <span class=m>232</span> KB           <span class=p>|</span>
    <span class=p>|</span> lcms2-2.12            <span class=p>|</span> h3be6417_0         <span class=m>312</span> KB           <span class=p>|</span>
    <span class=p>|</span> libpng-1.6.37         <span class=p>|</span> hbc83047_0         <span class=m>278</span> KB           <span class=p>|</span>
    <span class=p>|</span> libtiff-4.2.0         <span class=p>|</span> h85742a9_0         <span class=m>502</span> KB           <span class=p>|</span>
    <span class=p>|</span> libwebp-1.2.0         <span class=p>|</span> h89dd481_0         <span class=m>493</span> KB           <span class=p>|</span>
    <span class=p>|</span> libwebp-base-1.2.0    <span class=p>|</span> h27cfd23_0         <span class=m>437</span> KB           <span class=p>|</span>
    <span class=p>|</span> lz4-c-1.9.3           <span class=p>|</span> h295c915_1         <span class=m>185</span> KB           <span class=p>|</span>
    <span class=p>|</span> mkl-2021.4.0          <span class=p>|</span> h06a4308_640       142.6 MB         <span class=p>|</span>
    <span class=p>|</span> mkl-service-2.4.0     <span class=p>|</span> py37h7f8727e_0          <span class=m>56</span> KB       <span class=p>|</span>
    <span class=p>|</span> mkl_fft-1.3.1         <span class=p>|</span> py37hd3c417c_0         <span class=m>172</span> KB       <span class=p>|</span>
    <span class=p>|</span> mkl_random-1.2.2      <span class=p>|</span> py37h51133e4_0         <span class=m>287</span> KB       <span class=p>|</span>
    <span class=p>|</span> ninja-1.10.2          <span class=p>|</span> py37hd09550d_3         1.5 MB       <span class=p>|</span>
    <span class=p>|</span> numpy-1.21.2          <span class=p>|</span> py37h20f2e39_0          <span class=m>23</span> KB       <span class=p>|</span>
    <span class=p>|</span> numpy-base-1.21.2     <span class=p>|</span> py37h79a1101_0         4.8 MB       <span class=p>|</span>
    <span class=p>|</span> olefile-0.46          <span class=p>|</span> py37_0          <span class=m>50</span> KB               <span class=p>|</span>
    <span class=p>|</span> pillow-8.4.0          <span class=p>|</span> py37h5aabda8_0         <span class=m>644</span> KB       <span class=p>|</span>
    <span class=p>|</span> pytorch-1.6.0         <span class=p>|</span> py3.7_cpu_0        59.4 MB  pytorch <span class=p>|</span>
    <span class=p>|</span> pytorch-mutex-1.0     <span class=p>|</span> cpu           <span class=m>3</span> KB  pytorch         <span class=p>|</span>
    <span class=p>|</span> torchvision-0.7.0     <span class=p>|</span> py37_cpu        10.3 MB  pytorch    <span class=p>|</span>
    <span class=p>|</span> zstd-1.4.9            <span class=p>|</span> haebb681_0         <span class=m>480</span> KB           <span class=p>|</span>
    ------------------------------------------------------------
                                           Total:       227.4 MB

The following NEW packages will be INSTALLED:

  blas               pkgs/main/linux-64::blas-1.0-mkl
  cpuonly            pytorch/noarch::cpuonly-2.0-0
  freetype           pkgs/main/linux-64::freetype-2.11.0-h70c0345_0
  giflib             pkgs/main/linux-64::giflib-5.2.1-h7b6447c_0
  intel-openmp       pkgs/main/linux-64::intel-openmp-2021.4.0-h06a4308_3561
  jpeg               pkgs/main/linux-64::jpeg-9d-h7f8727e_0
  lcms2              pkgs/main/linux-64::lcms2-2.12-h3be6417_0
  libpng             pkgs/main/linux-64::libpng-1.6.37-hbc83047_0
  libtiff            pkgs/main/linux-64::libtiff-4.2.0-h85742a9_0
  libwebp            pkgs/main/linux-64::libwebp-1.2.0-h89dd481_0
  libwebp-base       pkgs/main/linux-64::libwebp-base-1.2.0-h27cfd23_0
  lz4-c              pkgs/main/linux-64::lz4-c-1.9.3-h295c915_1
  mkl                pkgs/main/linux-64::mkl-2021.4.0-h06a4308_640
  mkl-service        pkgs/main/linux-64::mkl-service-2.4.0-py37h7f8727e_0
  mkl_fft            pkgs/main/linux-64::mkl_fft-1.3.1-py37hd3c417c_0
  mkl_random         pkgs/main/linux-64::mkl_random-1.2.2-py37h51133e4_0
  ninja              pkgs/main/linux-64::ninja-1.10.2-py37hd09550d_3
  numpy              pkgs/main/linux-64::numpy-1.21.2-py37h20f2e39_0
  numpy-base         pkgs/main/linux-64::numpy-base-1.21.2-py37h79a1101_0
  olefile            pkgs/main/linux-64::olefile-0.46-py37_0
  pillow             pkgs/main/linux-64::pillow-8.4.0-py37h5aabda8_0
  pytorch            pytorch/linux-64::pytorch-1.6.0-py3.7_cpu_0
  pytorch-mutex      pytorch/noarch::pytorch-mutex-1.0-cpu
  six                pkgs/main/noarch::six-1.16.0-pyhd3eb1b0_0
  torchvision        pytorch/linux-64::torchvision-0.7.0-py37_cpu
  zstd               pkgs/main/linux-64::zstd-1.4.9-haebb681_0


Proceed <span class=o>([</span>y<span class=o>]</span>/n<span class=o>)</span>? y


Downloading and Extracting Packages
olefile-0.46         <span class=p>|</span> <span class=m>50</span> KB     <span class=p>|</span> <span class=c1>############################################################################################# | 100% </span>
numpy-base-1.21.2    <span class=p>|</span> 4.8 MB    <span class=p>|</span> <span class=c1>############################################################################################# | 100% </span>
libpng-1.6.37        <span class=p>|</span> <span class=m>278</span> KB    <span class=p>|</span> <span class=c1>############################################################################################# | 100% </span>
freetype-2.11.0      <span class=p>|</span> <span class=m>618</span> KB    <span class=p>|</span> <span class=c1>############################################################################################# | 100% </span>
libwebp-base-1.2.0   <span class=p>|</span> <span class=m>437</span> KB    <span class=p>|</span> <span class=c1>############################################################################################# | 100% </span>
blas-1.0             <span class=p>|</span> <span class=m>6</span> KB      <span class=p>|</span> <span class=c1>############################################################################################# | 100% </span>
libtiff-4.2.0        <span class=p>|</span> <span class=m>502</span> KB    <span class=p>|</span> <span class=c1>############################################################################################# | 100% </span>
torchvision-0.7.0    <span class=p>|</span> 10.3 MB   <span class=p>|</span> <span class=c1>############################################################################################# | 100% </span>
zstd-1.4.9           <span class=p>|</span> <span class=m>480</span> KB    <span class=p>|</span> <span class=c1>############################################################################################# | 100% </span>
pytorch-1.6.0        <span class=p>|</span> 59.4 MB   <span class=p>|</span> <span class=c1>############################################################################################# | 100% </span>
libwebp-1.2.0        <span class=p>|</span> <span class=m>493</span> KB    <span class=p>|</span> <span class=c1>############################################################################################# | 100% </span>
jpeg-9d              <span class=p>|</span> <span class=m>232</span> KB    <span class=p>|</span> <span class=c1>############################################################################################# | 100% </span>
intel-openmp-2021.4. <span class=p>|</span> 4.2 MB    <span class=p>|</span> <span class=c1>############################################################################################# | 100% </span>
lcms2-2.12           <span class=p>|</span> <span class=m>312</span> KB    <span class=p>|</span> <span class=c1>############################################################################################# | 100% </span>
mkl-service-2.4.0    <span class=p>|</span> <span class=m>56</span> KB     <span class=p>|</span> <span class=c1>############################################################################################# | 100% </span>
pytorch-mutex-1.0    <span class=p>|</span> <span class=m>3</span> KB      <span class=p>|</span> <span class=c1>############################################################################################# | 100% </span>
giflib-5.2.1         <span class=p>|</span> <span class=m>78</span> KB     <span class=p>|</span> <span class=c1>############################################################################################# | 100% </span>
mkl_random-1.2.2     <span class=p>|</span> <span class=m>287</span> KB    <span class=p>|</span> <span class=c1>############################################################################################# | 100% </span>
cpuonly-2.0          <span class=p>|</span> <span class=m>2</span> KB      <span class=p>|</span> <span class=c1>############################################################################################# | 100% </span>
mkl-2021.4.0         <span class=p>|</span> 142.6 MB  <span class=p>|</span> <span class=c1>############################################################################################# | 100% </span>
ninja-1.10.2         <span class=p>|</span> 1.5 MB    <span class=p>|</span> <span class=c1>############################################################################################# | 100% </span>
mkl_fft-1.3.1        <span class=p>|</span> <span class=m>172</span> KB    <span class=p>|</span> <span class=c1>############################################################################################# | 100% </span>
pillow-8.4.0         <span class=p>|</span> <span class=m>644</span> KB    <span class=p>|</span> <span class=c1>############################################################################################# | 100% </span>
lz4-c-1.9.3          <span class=p>|</span> <span class=m>185</span> KB    <span class=p>|</span> <span class=c1>############################################################################################# | 100% </span>
numpy-1.21.2         <span class=p>|</span> <span class=m>23</span> KB     <span class=p>|</span> <span class=c1>############################################################################################# | 100% </span>
Preparing transaction: <span class=k>done</span>
Verifying transaction: <span class=k>done</span>
Executing transaction: <span class=k>done</span>
</code></pre></div><h2 id=配置并运行bert>配置并运行BERT</h2>
<p>直接使用同CPU的命令<code>CUDA_VISIBLE_DEVICES=0 ./run_tod_lm_pretraining.sh 0 bert bert-base-uncased save/pretrain/ToD-BERT-MLM --only_last_turn --data_path ./../dialog_datasets</code>，貌似没有任何问题地跑起来了？</p>
<p>由于项目要求，需要限制模型使用cpu的核数。</p>
<p>使用命令<code>top -d 1</code>查看目前cpu占用情况，顺便查看跑BERT模型的python进程PID</p>
<p>使用命令<code>taskset -cp &lt;cpu list> &lt;pid></code>进行绑核操作，ep.<code>taskset -cp 0,1,2,3 94434</code></p>
<h2 id=reference>Reference</h2>
<p><a class=link href=https://zhuanlan.zhihu.com/p/94744929 target=_blank rel=noopener>Anaconda-用conda创建python虚拟环境</a></p>
</section>
<footer class=article-footer>
<section class=article-tags>
<a href=/tags/tod-bert/>ToD-BERT</a>
<a href=/tags/%E5%A4%A7%E5%88%9B-ai%E5%AF%B9%E8%AF%9D%E7%B3%BB%E7%BB%9F/>大创 AI对话系统</a>
<a href=/tags/anaconda/>Anaconda</a>
</section>
</footer>
</article>
<aside class=related-contents--wrapper>
<h2 class=section-title>Related contents</h2>
<div class=related-contents>
<div class="flex article-list--tile">
<article>
<a href=/p/debugging-tod-bert-with-vscode/>
<div class=article-details>
<h2 class=article-title>Debugging ToD-BERT with vscode</h2>
</div>
</a>
</article>
<article>
<a href=/p/%E5%A4%A7%E5%88%9B%E5%AF%B9%E8%AF%9D%E7%B3%BB%E7%BB%9F21.12.06%E7%BB%84%E4%BC%9A/>
<div class=article-details>
<h2 class=article-title>大创对话系统21.12.06组会</h2>
</div>
</a>
</article>
<article>
<a href=/p/%E5%A4%A7%E5%88%9B%E5%AF%B9%E8%AF%9D%E7%B3%BB%E7%BB%9F21.11.22%E7%BB%84%E4%BC%9A/>
<div class=article-details>
<h2 class=article-title>大创对话系统21.11.22组会</h2>
</div>
</a>
</article>
<article>
<a href=/p/tod-bert-%E7%9B%B8%E5%85%B3%E5%86%85%E5%AE%B9/>
<div class=article-details>
<h2 class=article-title>ToD-BERT 相关内容</h2>
</div>
</a>
</article>
</div>
</div>
</aside>
<div id=gitalk-container></div>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css>
<script src=https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/blueimp-md5@2.18.0/js/md5.min.js></script>
<script>const gitalk=new Gitalk({clientID:"0d5bb28ba48d7571aaae",clientSecret:"5b4b5a48ddaf1390937e89e0f88e1deede49e4f5",repo:"personal-blog-comment",owner:"Andyliu92",admin:["Andyliu92"],distractionFreeMode:!1,id:md5(location.pathname)});(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("gitalk-container").innerHTML="Gitalk comments not available by default when the website is previewed locally.";return}gitalk.render("gitalk-container")})()</script>
<footer class=site-footer>
<section class=copyright>
&copy;
2021 知止堂
</section>
<section class=powerby>
京ICP备2021035515号 <br>
Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> <br>
Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.5.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a>
</section>
</footer>
<div class=pswp tabindex=-1 role=dialog aria-hidden=true>
<div class=pswp__bg></div>
<div class=pswp__scroll-wrap>
<div class=pswp__container>
<div class=pswp__item></div>
<div class=pswp__item></div>
<div class=pswp__item></div>
</div>
<div class="pswp__ui pswp__ui--hidden">
<div class=pswp__top-bar>
<div class=pswp__counter></div>
<button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
<div class=pswp__preloader>
<div class=pswp__preloader__icn>
<div class=pswp__preloader__cut>
<div class=pswp__preloader__donut></div>
</div>
</div>
</div>
</div>
<div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
<div class=pswp__share-tooltip></div>
</div>
<button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
</button>
<div class=pswp__caption>
<div class=pswp__caption__center></div>
</div>
</div>
</div>
</div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous>
</main>
<aside class="sidebar right-sidebar sticky">
<section class="widget archives">
<div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg>
</div>
<h2 class="widget-title section-title">Table of contents</h2>
<div class=widget--toc>
<nav id=TableOfContents>
<ol>
<li><a href=#conda-复制已有环境>Conda 复制已有环境</a></li>
<li><a href=#conda配置环境中的包卸载gpu版本安装cpu版本>Conda配置环境中的包（卸载GPU版本、安装CPU版本）</a></li>
<li><a href=#配置并运行bert>配置并运行BERT</a></li>
<li><a href=#reference>Reference</a></li>
</ol>
</nav>
</div>
</section>
</aside>
</div>
<script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous defer></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const a=document.createElement('link');a.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",a.type="text/css",a.rel="stylesheet",document.head.appendChild(a)})()</script>
</body>
</html>